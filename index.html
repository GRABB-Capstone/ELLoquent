<!DOCTYPE html>
<html ng-app="submitExample">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


		<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.string/2.3.3/underscore.string.min.js"></script>
		<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/path.js/0.8.4/path.min.js"></script>		
		<script src="//www.parsecdn.com/js/parse-1.2.19.min.js"></script>		
		<script src="//cdn.rawgit.com/Artod/baascms/master/dist/baascms-1.0.0.min.js"></script>
		<script src="//cdn.rawgit.com/Artod/baascms/master/dist/baascms-adapter-parse-1.0.0.min.js"></script>
    		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.5/angular.min.js"></script
    		
    	
    		
    		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

		<!-- jQuery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

		<!-- Latest compiled JavaScript -->
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    		
    		<script>
			Parse.initialize('XlZQi8Z0dAIDNWjBmqWmNctcEjVA3NTNSVDF2fin', 'YlBsos14dteWEK9Ug2AsA8TpNiHCuPQQbDZMQcfh');
				BaasCMS.init({
			baas: 'Parse'
		});
			
			
		</script>
		
		
		
		<script>
		$(function(){
    $('[rel="popover"]').popover({
        container: 'body',
        html: true,
        content: function () {
            var clone = $($(this).data('popover-content')).clone(true).removeClass('hide');
            return clone;
        }
    }).click(function(e) {
        e.preventDefault();
    });
});
		</script>
		
<script>
  
  angular.module('submitExample', [])
    .controller('ExampleController', ['$scope', function($scope) {
      $scope.list = [];
      $scope.books =["one","two"];
/*	var Book = Parse.Object.extend("Book");
	var query = new Parse.Query(Book);
	query.find({
  	success: function(results) {
		$scope.books = results;
		$scope.fixedBooks = [];
		for (var i = 0; i < results.length; i++) {
			$scope.fixedBooks.push({title:results[i].get("title"),author:results[i].get("author"),grade:results[i].get("grade")});
			
			
		}
  	},
  	error: function(error) {
		alert("Error: " + error.code + " " + error.message);
	}
	});*/
  
      $scope.data;
      $scope.loggedIn = false;
      $scope.selectedBook = "";
      $scope.fixedBooks = [];
      $scope.leader=false;
      $scope.name;
      $scope.word;
      $scope.fileName;
      $scope.wordList  = [];
      $scope.grade;
      $scope.user;
      $scope.friends = [];
      $scope.key = function(){
      $scope.leader = true;
      }
      $scope.updateWords = function(){
		var Book= Parse.Object.extend("Book");
		var query = new Parse.Query(Book);
		query.equalTo("title", $scope.selectedBook.title);
		query.find({
  		success: function(results) {
  			$scope.wordList = results[0].get("words");
  		
  		},
  		error: function(error) {
			alert("Error: " + error.code + " " + error.message);
		}
		});
	}
	$scope.updateImages = function(){
		var Image= Parse.Object.extend("Image");
		var query = new Parse.Query(Image);
		query.equalTo("book", $scope.selectedBook.title);
		query.find({
  		success: function(results) {
  			$scope.imageList =[];
  			for (var i = 0; i < results.length; i++) {
				$scope.imageList.push({name:results[i].get("name"),url:results[i].get("image").url()});
			}

  		},
  		error: function(error) {
			alert("Error: " + error.code + " " + error.message);
		}
		});
	}
      $scope.show = function(){
	var Book = Parse.Object.extend("Book");
	var query = new Parse.Query(Book);
	query.find({
  	success: function(results) {
		$scope.books = results;
		$scope.fixedBooks = [];
		for (var i = 0; i < results.length; i++) {
			$scope.fixedBooks.push({title:results[i].get("title"),author:results[i].get("author"),grade:results[i].get("grade")});
			
		}
		//$scope.fixedBooks = _.map(results, function(item){ return{title: item.get("title")}});
  	},
  	error: function(error) {
		alert("Error: " + error.code + " " + error.message);
	}
	});
      }
      $scope.addImage = function(){
      	
      	var Book= Parse.Object.extend("Book");
	var query = new Parse.Query(Book);
	query.equalTo("title", $scope.selectedBook.title);
	query.find({
  	success: function(results) {
  		var imageUploadControl = $("#image")[0];
      		var parseImage;
      		$scope.imageName = $scope.image.slice(12);
      		if (imageUploadControl.files.length > 0) {
		  	var image = imageUploadControl.files[0];
   		 	var imageName = $scope.imageName;
   		 	parseImage = new Parse.File(imageName, image);
   		 	alert("Uploaded Image: " + parseImage);
      		}	
  		var Image= Parse.Object.extend("Image");
		var image= new Image();
  		image.set("image", parseImage);
  		image.set("name",imageName);
  		image.set("book",$scope.selectedBook.title);
  		image.save();
  		
  		results[0].addUnique("images",imageName);
  		results[0].save();
  	

  	},
  	error: function(error) {
		alert("Error: " + error.code + " " + error.message);
	}
		
		
       	
      });
      }
      $scope.addWord = function(){
      		if ($scope.wordList.includes($scope.word)){
      			alert("Word Already Exists");
      		}
      		else
      	  		$scope.wordList.push($scope.word);
							var Book= Parse.Object.extend("Book");
							var query = new Parse.Query(Book);
							query.equalTo("title", $scope.selectedBook.title);
							query.find({
  						success: function(results) {
  							results[0].addUnique("words",$scope.word);
  							results[0].save();
  						},
  						error: function(error) {
								alert("Error: " + error.code + " " + error.message);
							}
					});
	}
	$scope.login = function(){
		if ($scope.username == "bronan")
			$scope.loggedIn = true;
	
  	}
  	$scope.quickLogin = function(){

		$scope.loggedIn = true;
	
  	}
  	$scope.tryLogin = function(){
  	var user = Parse.User.logIn($scope.username, $scope.password, {
  		success: function(user) {
			$scope.login();
   
		}
		});	
  	}
  	$scope.test = function (x){
  		alert("test" + x);
  	}
  	$scope.trig = function (){
  		
  	
  			angular.element('#menu1').trigger('click');
  	}
  	
		
		
		
		
	
      
      $scope.submit = function() {
      	var fileUploadControl = $("#pic")[0];
      	var parseFile;
      	$scope.fileName = $scope.cover.slice(12);
      	if (fileUploadControl.files.length > 0) {
	   var file = fileUploadControl.files[0];
   	   var name = $scope.fileName;
   	   parseFile = new Parse.File(name, file);
   	   alert("Uploaded: " + name);
      	}
      	
      	var Book= Parse.Object.extend("Book");
      	//var acl= new Parse.ACL();
	var book= new Book();
	//var user= new Parse.User();
	book.set("title",$scope.name);
	book.set("author",$scope.author);
	book.set("grade", $scope.grade);
	book.set("bookPhoto", parseFile);
	book.set("words",[]);
	book.set("images",[]);
	//user.setUsername("username", $scope.user);
	//acl.setPublicReadAccess(false);
	//acl.setPublicWriteAccess(false);
	//acl.setReadAccess(user, true);
	//acl.setWriteAccess(user, true);
	//window.alert(user.getUsername());
	//book.setACL(acl);
	book.save();
	$scope.fixedBooks.push({title:$scope.name,author:$scope.author,grade:$scope.grade});
      };
    }]);
       
       
// and fire it after definition
</script>



</head>

<body>







<div ng-controller="ExampleController" data-ng-init="show()">

	<div class="container">
		<div class="jumbotron">
			<h1 class="text-center"> Elloquent 2.4 </h1>
			<h3 class="text-center"> Quick Login Enabled, just click log in</h3>
		</div>	
	</div>

	<div class = "container" ng-hide="loggedIn == true">
        <input class="form-control"  type="text"  placeholder="Example: myUsername " ng-model="username" />
        <input class="form-control"  type="text"  placeholder="Example: myPassword " ng-model="password" />
	<input class="btn btn-primary btn-block" type="submit" id="passCode" value="Log In" ng-click="quickLogin()"  />
	</div>

	<div ng-show="loggedIn == true" data-ng-init="show()">

		<div class="container">
  		<h2>Navigation Bar</h2>
		<ul class="nav nav-tabs">
    			<li class="active"><a data-toggle="tab" href="#content">View Content</a></li>
    			<li><a data-toggle="tab" href="#home" ng-click="showme = false">Books</a></li>
		 	<li><a data-toggle="tab" href="#menu1" ng-click="showme = false">Words</a></li>
    			<li><a data-toggle="tab" href="#menu2" ng-click="showme = false">Images</a></li>
    			<li><a data-toggle="tab" href="#menu3" ng-click="showme = false">Search?</a></li>
  		</ul>


  		<div class="tab-content">
  		<div id="content" class="tab-pane fade in active">
      		<h3>View Content </h3>
      			<div class="container"  >
  				<table class="table table-hover">
  					<col width="130">
  					<col width="80">
    				<tr>
    					
      					<th>Title</th>
      					<th>Author</th>
      					<th>Button</th>
      					
					 </tr>
    				<tr ng-repeat="book in fixedBooks">
      					<td>{{book.title}}</td>
      					<td>{{book.author}}</td>
      					<td>
      						
      						
      				
      						
      						
      					<h3>Add Word:</h3>

      				
      						
 <form class="form-inline">
    <input type="text" class="form-control" id="addwordtemp" placeholder="Wizard" ng-model ="word">
    <button type="submit" class="btn" id="addWord" value="Add Word" ng-click="trig()" ng-disabled="!word"></button>
</form>
 
 
 
      						
      						
      					</td>
      					
      					
      					
      					
      					
			 		</tr>
  				</table>
			</div>
      		
      		</div>
    		<div id="home" class="tab-pane fade">
      			<h3>Add a Book</h3>
      
			 	<div class="container">
      				<h3>Book Title:</h3>
      				<input class="form-control"  type="text"  placeholder="Example: Harry Potter" ng-model="name" name="name2" />
      				<h3>Author:</h3>
      				<input class="form-control"  type="text"  placeholder="Example: J.K. Rowling" ng-model="author" />
    				<h3>Grade Level:</h3>
      				<input class="form-control"  type="text"  placeholder="Example: Grade 4" ng-model="grade"/>
      				<h3>Username:</h3>
    			 	<input class="form-control"  type="text"  placeholder="Example: bronan" ng-model="user"/>
      				<h3>Book Cover:</h3>
      				<input type="file" id="pic" ng-model="cover"/>

      				<p></p>
      				<input class="btn btn-primary btn-block" type="submit" id="submit" value="Submit" ng-click="submit()" ng-disabled="!name || !author || !grade || !user || !cover"/>
      

					<input class="btn btn-primary btn-block form-control" type="submit" id="remove" value="Remove Books" ng-mouseover = "show()" ng-click="showme=false" ng-show = "showme"/>
        			<input class="btn btn-primary btn-block form-control" type="submit" id="key" value="Show Books" ng-mouseover = "show()" ng-click="showme=true" ng-hide = "showme"/>
				</div >
  


   	 
 
			<div class="container"  ng-show="showme">
  				<table class="table table-hover">
    				<tr>
      					<th>Title</th>
      					<th>Author</th>
					 </tr>
    				<tr ng-repeat="book in fixedBooks">
      					<td>{{book.title}}</td>
      					<td>{{book.author}}</td>
			 		</tr>
  				</table>
			</div>
      
      
    		</div>
    		<div id="menu1" class="tab-pane fade">
      			<h3>Add Words to a Book </h3>
 
	 			<div class="container">
					<label for="repeatSelect"> Choose Book: </label>
    				<select class="form-control" ng-model="selectedBook" ng-options="book.title for book in fixedBooks" ng-mouseover= "updateWords()">
    					<option value="">Select one</option>
    				</select>
				</div>

   	 
 
				<div class="container"  ng-show="showme">
  					<table class="table table-hover">
	  					<tr>
		  					<th>Title</th>
      						<th>Author</th>
	 					</tr>
    					<tr ng-repeat="book in fixedBooks">
      						<td>{{book.title}}</td>
      						<td>{{book.author}}</td>
    					</tr>
					</table>
				</div>

				<div class = "container">
					<h3>Add Word:</h3>
		   			<input class="form-control"  type="text"  placeholder="Example: Technology" ng-model="word"/>
		     	 	<input class="btn btn-primary btn-block" type="submit" id="addWord" value="Add Word" ng-click="addWord()" ng-disabled="!word"/>
					<input class="btn btn-primary btn-block form-control" type="submit" id="remove" ng-mouseover = "updateWords()" value="Remove Words" ng-click="showmeWords=false;updateWords(); " ng-show = "showmeWords"/>
					<input class="btn btn-primary btn-block form-control" type="submit" id="key" ng-mouseover = "updateWords()" value="Show Words" ng-click="showmeWords=true;updateWords();" ng-hide = "showmeWords"/ ng-disabled="!selectedBook.title">
				</div>

				<div class="container"  ng-show="showmeWords">
  					<table class="table table-hover">
    					<tr>
      					<th>Words</th>
		 			</tr>
    				<tr ng-repeat="word in wordList track by $index">
      					<td>{{word}}</td>
    				</tr>
  					</table>


				</div>

	 		</div>
	 		
	 		<div id="menu2" class="tab-pane fade">
      				<h3>Add Images to a Book</h3>

      				<div class="container">
					<label for="repeatSelect"> Choose Book: </label>
					
					
					
    					<select class="form-control" ng-model="selectedBook" ng-options="book.title for book in fixedBooks" ng-mouseover = "updateImages()">
    					
    					
    					
    					<option value="">Select one</option>
    				</select>
				</div>

   	 
 
			

				<div class = "container">
					<h3>Add Image:</h3>
		     	 		<input  type="file" id="image" ng-model="image"/>
		     	 		<input class="btn btn-primary btn-block" type="submit" id="addImage" value="Add Image" ng-click="addImage()" ng-disabled="!image"/>
		     	 		<input class="btn btn-primary btn-block form-control" type="submit" id="hideImage" value="Remove Images" ng-mouseover = "updateImages()" ng-click="showmeImages=false;updateImages(); " ng-show = "showmeImages"/>
					<input class="btn btn-primary btn-block form-control" type="submit" id="showImage" value="Show Images"  ng-mouseover = "updateImages()" ng-click="showmeImages=true;updateImages();" ng-hide = "showmeImages"/ ng-disabled="!selectedBook.title">


				</div>
				
				<div class = "container" ng-show="showmeImages">
					<h3>Images:</h3>
					<div class="container">
  					<table class="table table-hover">
    					<tr>
    						<th>Name</th>
      						<th>Image</th>
		 					</tr>
    					<tr ng-repeat="image in imageList track by $index" >
    						<td ng-mouseover = "test(image.name)">{{image.name}} </td>
    						<td><img ng-src="{{image.url}}" style="height:128px;" />	</td>
    					</tr>
  					</table>


				</div>
				</div>

			
      				
      				
    		</div>
    
   		</div>

		</div>
	</div>
</div>





</body>
</html>
